{
  "entities": {
    "UserAccount": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserAccount",
      "type": "object",
      "description": "Represents a user's account within the MX Sweeps Exchange.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user account."
        },
        "mxRacehubId": {
          "type": "string",
          "description": "The unique identifier of the user's account on MXRacehub."
        },
        "sweepsCoinBalance": {
          "type": "number",
          "description": "The user's sweeps coin balance.",
          "format": "float"
        },
        "usdBalance": {
          "type": "number",
          "description": "The user's USD balance.",
          "format": "float"
        },
        "lastSyncDate": {
          "type": "string",
          "description": "The date and time of the last successful synchronization with MXRacehub.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "mxRacehubId",
        "sweepsCoinBalance",
        "usdBalance"
      ]
    },
    "Transaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Transaction",
      "type": "object",
      "description": "Represents a transaction involving sweeps coins or USD.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the transaction."
        },
        "userAccountId": {
          "type": "string",
          "description": "Reference to UserAccount. The ID of the user account associated with this transaction. (Relationship: UserAccount 1:N Transaction)"
        },
        "transactionType": {
          "type": "string",
          "description": "The type of transaction (e.g., 'deposit', 'withdrawal', 'exchange')."
        },
        "amount": {
          "type": "number",
          "description": "The amount of sweeps coins or USD involved in the transaction.",
          "format": "float"
        },
        "currency": {
          "type": "string",
          "description": "The currency of the transaction (e.g., 'sweeps', 'usd')."
        },
        "transactionDate": {
          "type": "string",
          "description": "The date and time of the transaction.",
          "format": "date-time"
        },
        "exchangeRate": {
          "type": "number",
          "description": "The exchange rate used for the transaction, if applicable (e.g., sweeps to USD).",
          "format": "float"
        }
      },
      "required": [
        "id",
        "userAccountId",
        "transactionType",
        "amount",
        "currency",
        "transactionDate"
      ]
    },
    "WithdrawalRequest": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WithdrawalRequest",
      "type": "object",
      "description": "Represents a user's request to withdraw USD from their account.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the withdrawal request."
        },
        "userAccountId": {
          "type": "string",
          "description": "Reference to UserAccount. The ID of the user account associated with this withdrawal request. (Relationship: UserAccount 1:N WithdrawalRequest)"
        },
        "amount": {
          "type": "number",
          "description": "The amount of USD requested for withdrawal.",
          "format": "float"
        },
        "paymentMethod": {
          "type": "string",
          "description": "The user's selected payment method for the withdrawal (e.g., 'PayPal', 'Bank Transfer')."
        },
        "paymentDetails": {
          "type": "string",
          "description": "Additional details required for the selected payment method (e.g., PayPal email address, bank account number)."
        },
        "requestDate": {
          "type": "string",
          "description": "The date and time the withdrawal request was submitted.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "The status of the withdrawal request (e.g., 'pending', 'approved', 'rejected', 'completed')."
        }
      },
      "required": [
        "id",
        "userAccountId",
        "amount",
        "paymentMethod",
        "paymentDetails",
        "requestDate",
        "status"
      ]
    },
    "ComplianceAlert": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ComplianceAlert",
      "type": "object",
      "description": "Represents an alert generated by the compliance tool for suspicious activity.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the compliance alert."
        },
        "userAccountId": {
          "type": "string",
          "description": "Reference to UserAccount. The ID of the user account associated with the alert. (Relationship: UserAccount 1:N ComplianceAlert)"
        },
        "transactionId": {
          "type": "string",
          "description": "Reference to Transaction. The ID of the transaction that triggered the alert. (Relationship: Transaction 1:N ComplianceAlert)"
        },
        "alertType": {
          "type": "string",
          "description": "The type of compliance alert (e.g., 'large_transaction', 'unusual_activity')."
        },
        "alertDate": {
          "type": "string",
          "description": "The date and time the compliance alert was generated.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the suspicious activity that triggered the alert."
        },
        "resolved": {
          "type": "boolean",
          "description": "Indicates whether the alert has been resolved by an administrator."
        }
      },
      "required": [
        "id",
        "userAccountId",
        "alertType",
        "alertDate",
        "description",
        "resolved"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/userAccounts/{userAccountId}",
        "definition": {
          "entityName": "UserAccount",
          "schema": {
            "$ref": "#/backend/entities/UserAccount"
          },
          "description": "Stores user account information. Uses path-based ownership for security.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "userAccountId",
              "description": "The unique identifier for the user account."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/transactions/{transactionId}",
        "definition": {
          "entityName": "Transaction",
          "schema": {
            "$ref": "#/backend/entities/Transaction"
          },
          "description": "Stores transaction history for each user. Uses path-based ownership for security.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "transactionId",
              "description": "The unique identifier for the transaction."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/withdrawalRequests/{withdrawalRequestId}",
        "definition": {
          "entityName": "WithdrawalRequest",
          "schema": {
            "$ref": "#/backend/entities/WithdrawalRequest"
          },
          "description": "Stores withdrawal requests. Uses path-based ownership for security.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "withdrawalRequestId",
              "description": "The unique identifier for the withdrawal request."
            }
          ]
        }
      },
      {
        "path": "/complianceAlerts/{complianceAlertId}",
        "definition": {
          "entityName": "ComplianceAlert",
          "schema": {
            "$ref": "#/backend/entities/ComplianceAlert"
          },
          "description": "Stores compliance alerts. Requires admin access.",
          "params": [
            {
              "name": "complianceAlertId",
              "description": "The unique identifier for the compliance alert."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to securely manage user accounts, transactions, withdrawal requests, and compliance alerts for the MX Sweeps Exchange application. Prioritizing Authorization Independence, the structure avoids hierarchical dependencies and relies on denormalization to ensure robust security rules. Each collection is designed with a homogeneous security posture. Path-based ownership is used for user-specific data, and the membership map model is not required given there is no sharing amongst users.\n\n*   `/users/{userId}/userAccounts/{userAccountId}`: Stores user account details. This collection uses path-based ownership. User accounts are namespaced under the user's ID for easy management and enhanced security.\n*   `/users/{userId}/transactions/{transactionId}`: Stores transaction history for each user, namespaced by user ID.\n*   `/users/{userId}/withdrawalRequests/{withdrawalRequestId}`: Stores withdrawal requests, also namespaced by user ID.\n*   `/complianceAlerts/{complianceAlertId}`: Stores compliance alerts, using a flat collection structure. This collection requires special admin access, so no denormalization is required."
  }
}